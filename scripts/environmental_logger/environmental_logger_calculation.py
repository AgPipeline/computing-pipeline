import numpy as np

__all__ = ["AREA", "FLX_SNS", "calculateDownwellingSpectralFlux"]

#Fibre optic collection surface area is pi * (fiber diameter squared) / 4
AREA = np.pi * (3900.0 * 1.0e-6) ** 2 / 4.0  # [m2]

# flx_sns@provenance="EnvironmentalLogger calibration information from file S05673_08062015.IrradCal provided by TinoDornbusch and discussed here: https://github.com/terraref/reference-data/issues/30#issuecomment-217518434";
#_FLX_SNS comment: [uJ cnt-1] 10 sensitivities per line, 1024 total
FLX_SNS = \
    [2.14905162e-3, 2.14905162e-3, 2.13191329e-3, 2.09958721e-3, 2.07255014e-3, 2.04042869e-3, 2.01065201e-3, 1.98247712e-3, 1.95695595e-3, 1.93084270e-3,
     1.90570597e-3, 1.87482001e-3, 1.85556117e-3, 1.83111292e-3, 1.80493827e-3, 1.78204243e-3, 1.76011709e-3, 1.74298970e-3, 1.72493868e-3, 1.70343113e-3,
     1.68553722e-3, 1.66631622e-3, 1.65443041e-3, 1.63642311e-3, 1.61846215e-3, 1.60545573e-3, 1.59131286e-3, 1.57713520e-3, 1.56105571e-3, 1.54524417e-3,
     1.53346351e-3, 1.51857527e-3, 1.50523348e-3, 1.49241475e-3, 1.47961893e-3, 1.46809459e-3, 1.45371019e-3, 1.44115770e-3, 1.42656173e-3, 1.41449893e-3,
     1.40218325e-3, 1.38727829e-3, 1.37516400e-3, 1.36250816e-3, 1.34930545e-3, 1.33658553e-3, 1.32360948e-3, 1.31037104e-3, 1.29485640e-3, 1.28218362e-3,
     1.26643446e-3, 1.25134745e-3, 1.23774104e-3, 1.22154062e-3, 1.20610594e-3, 1.19103569e-3, 1.17634593e-3, 1.16196432e-3, 1.14706609e-3, 1.13382928e-3,
     1.11918389e-3, 1.10556178e-3, 1.09188557e-3, 1.07918790e-3, 1.06742601e-3, 1.05718118e-3, 1.04694473e-3, 1.03659582e-3, 1.02873900e-3, 1.02288609e-3,
     1.01628109e-3, 1.01158157e-3, 1.00762812e-3, 1.00491506e-3, 9.99889414e-4, 9.95638736e-4, 9.91223764e-4, 9.86536043e-4, 9.82378851e-4, 9.75992983e-4,
     9.68055921e-4, 9.60360601e-4, 9.52229616e-4, 9.44288731e-4, 9.35551583e-4, 9.27778978e-4, 9.19234295e-4, 9.10434775e-4, 9.02072493e-4, 8.94082691e-4,
     8.86054070e-4, 8.80176269e-4, 8.73884929e-4, 8.67741565e-4, 8.61294713e-4, 8.55225782e-4, 8.50034434e-4, 8.44592095e-4, 8.39026291e-4, 8.32991645e-4,
     8.27232672e-4, 8.20422797e-4, 8.12627476e-4, 8.03944155e-4, 7.93686106e-4, 7.82697718e-4, 7.71489658e-4, 7.58484857e-4, 7.47988099e-4, 7.37636214e-4,
     7.28366631e-4, 7.19162810e-4, 7.11125553e-4, 7.03209565e-4, 6.94909585e-4, 6.86758690e-4, 6.78942712e-4, 6.70144668e-4, 6.62797996e-4, 6.54343779e-4,
     6.46170305e-4, 6.38872127e-4, 6.30959379e-4, 6.25264821e-4, 6.19260059e-4, 6.14223740e-4, 6.09600378e-4, 6.04109797e-4, 5.99684341e-4, 5.94762462e-4,
     5.89358438e-4, 5.84542583e-4, 5.79374467e-4, 5.76250247e-4, 5.72012513e-4, 5.68631187e-4, 5.65821491e-4, 5.62718648e-4, 5.59116033e-4, 5.55411029e-4,
     5.51801247e-4, 5.47598043e-4, 5.43247327e-4, 5.37762461e-4, 5.33460619e-4, 5.28878572e-4, 5.23689536e-4, 5.19266009e-4, 5.14458405e-4, 5.10751276e-4,
     5.07003427e-4, 5.03165882e-4, 4.98966826e-4, 4.96001001e-4, 4.93715941e-4, 4.90249980e-4, 4.86771807e-4, 4.83624709e-4, 4.80476687e-4, 4.76929878e-4,
     4.74001018e-4, 4.70608674e-4, 4.66770209e-4, 4.64581056e-4, 4.61759438e-4, 4.59189259e-4, 4.57332260e-4, 4.55348303e-4, 4.53789335e-4, 4.51997104e-4,
     4.51229308e-4, 4.49813718e-4, 4.49043888e-4, 4.48243809e-4, 4.47227105e-4, 4.45901662e-4, 4.44320515e-4, 4.42138136e-4, 4.40911947e-4, 4.38857020e-4,
     4.36114912e-4, 4.32791420e-4, 4.29184734e-4, 4.26039764e-4, 4.23760025e-4, 4.20638491e-4, 4.17739943e-4, 4.15334137e-4, 4.13241033e-4, 4.10672248e-4,
     4.08480950e-4, 4.07521131e-4, 4.06620556e-4, 4.05633162e-4, 4.04394743e-4, 4.02768826e-4, 4.01579752e-4, 4.00290096e-4, 3.98392706e-4, 3.96699174e-4,
     3.94234388e-4, 3.91851912e-4, 3.89154416e-4, 3.86231981e-4, 3.83777232e-4, 3.81168698e-4, 3.78433645e-4, 3.76298344e-4, 3.74215227e-4, 3.72197441e-4,
     3.70207284e-4, 3.68657365e-4, 3.67545261e-4, 3.66319403e-4, 3.65206679e-4, 3.63557693e-4, 3.62294538e-4, 3.61179418e-4, 3.58947889e-4, 3.56599608e-4,
     3.53923148e-4, 3.51224187e-4, 3.48070600e-4, 3.44364936e-4, 3.40781769e-4, 3.37471420e-4, 3.33912295e-4, 3.30235172e-4, 3.26561393e-4, 3.23282422e-4,
     3.20050433e-4, 3.17180477e-4, 3.14219227e-4, 3.11600742e-4, 3.09493381e-4, 3.07471257e-4, 3.05484183e-4, 3.03684277e-4, 3.01998980e-4, 3.00340107e-4,
     2.98343918e-4, 2.96867620e-4, 2.94945050e-4, 2.93219375e-4, 2.91688135e-4, 2.89922856e-4, 2.87800025e-4, 2.85461354e-4, 2.83757039e-4, 2.81377961e-4,
     2.79552629e-4, 2.77642310e-4, 2.75503391e-4, 2.73875335e-4, 2.72347155e-4, 2.70900748e-4, 2.69293738e-4, 2.67858074e-4, 2.66460300e-4, 2.65251110e-4,
     2.64275292e-4, 2.63248240e-4, 2.62327379e-4, 2.61579696e-4, 2.60818456e-4, 2.60002965e-4, 2.58705340e-4, 2.57752670e-4, 2.56913992e-4, 2.56361785e-4,
     2.55265269e-4, 2.54289030e-4, 2.53369783e-4, 2.52709129e-4, 2.51737103e-4, 2.50397300e-4, 2.48911620e-4, 2.47940106e-4, 2.46958831e-4, 2.46000402e-4,
     2.44657610e-4, 2.42959871e-4, 2.41646677e-4, 2.40071179e-4, 2.38572274e-4, 2.37125904e-4, 2.35921992e-4, 2.34980504e-4, 2.34028683e-4, 2.32572352e-4,
     2.31160035e-4, 2.29885626e-4, 2.28995291e-4, 2.28016467e-4, 2.26725040e-4, 2.25484801e-4, 2.23893466e-4, 2.22942513e-4, 2.21397987e-4, 2.19729430e-4,
     2.18184785e-4, 2.16237560e-4, 2.14867776e-4, 2.13119570e-4, 2.11095792e-4, 2.09431424e-4, 2.07369328e-4, 2.05197478e-4, 2.02992714e-4, 2.00995783e-4,
     1.99040628e-4, 1.97330365e-4, 1.95128937e-4, 1.92897050e-4, 1.90828812e-4, 1.88848992e-4, 1.86812770e-4, 1.85107403e-4, 1.83851878e-4, 1.81970227e-4,
     1.80471463e-4, 1.78981517e-4, 1.77286120e-4, 1.76392581e-4, 1.75098596e-4, 1.74137351e-4, 1.73190515e-4, 1.72166132e-4, 1.71231374e-4, 1.70366007e-4,
     1.69568760e-4, 1.68589267e-4, 1.67791363e-4, 1.66897578e-4, 1.65888439e-4, 1.65083935e-4, 1.64157795e-4, 1.63088458e-4, 1.62054638e-4, 1.60921204e-4,
     1.59597998e-4, 1.58591166e-4, 1.57448762e-4, 1.55975979e-4, 1.54945634e-4, 1.53768607e-4, 1.52490862e-4, 1.51237859e-4, 1.50099128e-4, 1.49111429e-4,
     1.47998498e-4, 1.47145525e-4, 1.46192385e-4, 1.45307609e-4, 1.44594903e-4, 1.43689016e-4, 1.42978840e-4, 1.42385947e-4, 1.41618642e-4, 1.41296459e-4,
     1.40736609e-4, 1.40128598e-4, 1.39496377e-4, 1.38800776e-4, 1.38248154e-4, 1.37619848e-4, 1.37121202e-4, 1.36531523e-4, 1.35719098e-4, 1.35125606e-4,
     1.34189288e-4, 1.33450058e-4, 1.32766920e-4, 1.31885017e-4, 1.31122573e-4, 1.30328488e-4, 1.29426836e-4, 1.28660144e-4, 1.27935543e-4, 1.27252022e-4,
     1.26480762e-4, 1.25668248e-4, 1.24922118e-4, 1.24410907e-4, 1.23808009e-4, 1.23163911e-4, 1.22517652e-4, 1.21996101e-4, 1.21426745e-4, 1.20795188e-4,
     1.20351946e-4, 1.19824156e-4, 1.19435754e-4, 1.19034938e-4, 1.18434743e-4, 1.18058836e-4, 1.17753346e-4, 1.17341202e-4, 1.17001634e-4, 1.16538566e-4,
     1.16315189e-4, 1.16025052e-4, 1.15877025e-4, 1.15561180e-4, 1.15133517e-4, 1.14836326e-4, 1.14582204e-4, 1.14243860e-4, 1.14197033e-4, 1.13911263e-4,
     1.13780203e-4, 1.13241434e-4, 1.12847757e-4, 1.12518590e-4, 1.12240191e-4, 1.12090644e-4, 1.11898539e-4, 1.11697770e-4, 1.11478439e-4, 1.11055915e-4,
     1.11038903e-4, 1.10892821e-4, 1.10844792e-4, 1.10832493e-4, 1.10685454e-4, 1.10585787e-4, 1.10523459e-4, 1.10538204e-4, 1.10352101e-4, 1.10342922e-4,
     1.10281513e-4, 1.10136790e-4, 1.10034253e-4, 1.10161106e-4, 1.10100572e-4, 1.10110098e-4, 1.10080592e-4, 1.09984173e-4, 1.09845052e-4, 1.09851854e-4,
     1.09905915e-4, 1.10028217e-4, 1.10035987e-4, 1.09960749e-4, 1.09766410e-4, 1.09785602e-4, 1.09799006e-4, 1.09935387e-4, 1.09996957e-4, 1.10015594e-4,
     1.09970966e-4, 1.09805155e-4, 1.09719944e-4, 1.09678392e-4, 1.09725399e-4, 1.09808313e-4, 1.09636200e-4, 1.09535133e-4, 1.09295215e-4, 1.09169349e-4,
     1.09191375e-4, 1.09233527e-4, 1.09205113e-4, 1.09120552e-4, 1.09119671e-4, 1.08973612e-4, 1.08924114e-4, 1.08891026e-4, 1.08907229e-4, 1.08986240e-4,
     1.08900531e-4, 1.08753082e-4, 1.08703896e-4, 1.08787039e-4, 1.08795093e-4, 1.08699656e-4, 1.08837754e-4, 1.08804051e-4, 1.08825203e-4, 1.08836245e-4,
     1.08750606e-4, 1.08911309e-4, 1.08993157e-4, 1.09019453e-4, 1.08906882e-4, 1.08830389e-4, 1.08786024e-4, 1.08648784e-4, 1.08543831e-4, 1.08526696e-4,
     1.08346842e-4, 1.08177325e-4, 1.07894351e-4, 1.07585013e-4, 1.07355722e-4, 1.07161797e-4, 1.07018269e-4, 1.06701081e-4, 1.06490135e-4, 1.06148921e-4,
     1.05780669e-4, 1.05519970e-4, 1.05237804e-4, 1.05018149e-4, 1.04960672e-4, 1.04759539e-4, 1.04540409e-4, 1.04335532e-4, 1.04248329e-4, 1.04080729e-4,
     1.04091425e-4, 1.04055083e-4, 1.04023531e-4, 1.03982955e-4, 1.03897792e-4, 1.03664565e-4, 1.03597003e-4, 1.03534202e-4, 1.03538706e-4, 1.03610086e-4,
     1.03562393e-4, 1.03382849e-4, 1.03208570e-4, 1.03080933e-4, 1.03024256e-4, 1.03051061e-4, 1.03046453e-4, 1.02968720e-4, 1.02813488e-4, 1.02603014e-4,
     1.02234419e-4, 1.02028022e-4, 1.01905582e-4, 1.01804529e-4, 1.01678913e-4, 1.01525915e-4, 1.01235735e-4, 1.01002510e-4, 1.00753430e-4, 1.00514078e-4,
     1.00437680e-4, 1.00426425e-4, 1.00342652e-4, 1.00324563e-4, 1.00193735e-4, 9.99614188e-5, 9.97959450e-5, 9.96635685e-5, 9.95680633e-5, 9.95295601e-5,
     9.95419478e-5, 9.93610409e-5, 9.92005015e-5, 9.89874238e-5, 9.87621992e-5, 9.86741797e-5, 9.86446806e-5, 9.87023188e-5, 9.86904988e-5, 9.87196887e-5,
     9.86048564e-5, 9.84391907e-5, 9.83676057e-5, 9.83207848e-5, 9.84386405e-5, 9.84955583e-5, 9.85247638e-5, 9.85229229e-5, 9.84406010e-5, 9.83803668e-5,
     9.83439478e-5, 9.83296520e-5, 9.84439321e-5, 9.85235870e-5, 9.85655663e-5, 9.84966496e-5, 9.84488197e-5, 9.84056559e-5, 9.83206327e-5, 9.81939782e-5,
     9.83002829e-5, 9.82246562e-5, 9.82700124e-5, 9.83010388e-5, 9.82759501e-5, 9.81680327e-5, 9.80868465e-5, 9.80081521e-5, 9.80084773e-5, 9.80201149e-5,
     9.81387400e-5, 9.80116911e-5, 9.80144351e-5, 9.79589533e-5, 9.78046061e-5, 9.76346492e-5, 9.76720556e-5, 9.76000615e-5, 9.76940237e-5, 9.76700649e-5,
     9.76436554e-5, 9.76217315e-5, 9.75644547e-5, 9.74582521e-5, 9.73723677e-5, 9.75158846e-5, 9.76063227e-5, 9.76576561e-5, 9.78378613e-5, 9.78764318e-5,
     9.78355668e-5, 9.79053556e-5, 9.78971200e-5, 9.79906854e-5, 9.80966670e-5, 9.83212609e-5, 9.83661316e-5, 9.85426549e-5, 9.86024674e-5, 9.86590075e-5,
     9.86276988e-5, 9.87354712e-5, 9.87754605e-5, 9.89135932e-5, 9.91850242e-5, 9.94027993e-5, 9.94630471e-5, 9.95331627e-5, 9.95927355e-5, 9.96449255e-5,
     9.96738155e-5, 9.97903713e-5, 9.99867011e-5, 1.00180641e-4, 1.00305263e-4, 1.00350675e-4, 1.00337790e-4, 1.00368296e-4, 1.00386643e-4, 1.00381686e-4,
     1.00519126e-4, 1.00708351e-4, 1.00900376e-4, 1.00985285e-4, 1.01155946e-4, 1.01232434e-4, 1.01246029e-4, 1.01294137e-4, 1.01423141e-4, 1.01638838e-4,
     1.01812099e-4, 1.01937894e-4, 1.02167422e-4, 1.02253729e-4, 1.02424793e-4, 1.02521930e-4, 1.02690121e-4, 1.02839311e-4, 1.03089113e-4, 1.03250475e-4,
     1.03431580e-4, 1.03716033e-4, 1.03938607e-4, 1.04117939e-4, 1.04384106e-4, 1.04529677e-4, 1.04654582e-4, 1.04814310e-4, 1.05092692e-4, 1.05413737e-4,
     1.05740355e-4, 1.06083661e-4, 1.06308365e-4, 1.06565438e-4, 1.06629335e-4, 1.06744210e-4, 1.06882442e-4, 1.07187881e-4, 1.07381175e-4, 1.07571985e-4,
     1.07752337e-4, 1.07958784e-4, 1.08010861e-4, 1.08075778e-4, 1.08124883e-4, 1.08257449e-4, 1.08419171e-4, 1.08593318e-4, 1.08694174e-4, 1.08884465e-4,
     1.09042040e-4, 1.09206302e-4, 1.09350437e-4, 1.09438760e-4, 1.09607358e-4, 1.09782787e-4, 1.09955758e-4, 1.10091358e-4, 1.10285940e-4, 1.10491229e-4,
     1.10742419e-4, 1.10907433e-4, 1.10989206e-4, 1.10994674e-4, 1.11224947e-4, 1.11275260e-4, 1.11379372e-4, 1.11598462e-4, 1.11899867e-4, 1.12232203e-4,
     1.12446731e-4, 1.12641100e-4, 1.12842223e-4, 1.13075513e-4, 1.13342586e-4, 1.13508149e-4, 1.13820379e-4, 1.14203203e-4, 1.14490663e-4, 1.14760307e-4,
     1.15092754e-4, 1.15469416e-4, 1.15670149e-4, 1.16009156e-4, 1.16271820e-4, 1.16580050e-4, 1.16902429e-4, 1.17308313e-4, 1.17666409e-4, 1.18021025e-4,
     1.18417002e-4, 1.18680029e-4, 1.18865319e-4, 1.19262047e-4, 1.19437496e-4, 1.19686615e-4, 1.19978762e-4, 1.20252739e-4, 1.20473473e-4, 1.20770056e-4,
     1.21090033e-4, 1.21331608e-4, 1.21505469e-4, 1.21699316e-4, 1.21782412e-4, 1.21974020e-4, 1.22103237e-4, 1.22231939e-4, 1.22420471e-4, 1.22581870e-4,
     1.22711136e-4, 1.22866496e-4, 1.22913279e-4, 1.23115711e-4, 1.23199889e-4, 1.23323819e-4, 1.23461205e-4, 1.23642315e-4, 1.23796507e-4, 1.24020468e-4,
     1.24238753e-4, 1.24422114e-4, 1.24625589e-4, 1.24860150e-4, 1.24989076e-4, 1.25232771e-4, 1.25461347e-4, 1.25751417e-4, 1.26039690e-4, 1.26363122e-4,
     1.26586473e-4, 1.26874300e-4, 1.27211480e-4, 1.27449080e-4, 1.27810195e-4, 1.28112243e-4, 1.28496922e-4, 1.28769318e-4, 1.28988874e-4, 1.29308334e-4,
     1.29681533e-4, 1.30081273e-4, 1.30484797e-4, 1.30834377e-4, 1.31195470e-4, 1.31542514e-4, 1.31971306e-4, 1.32327207e-4, 1.32671516e-4, 1.33163904e-4,
     1.33602896e-4, 1.34007504e-4, 1.34403545e-4, 1.34785880e-4, 1.35232311e-4, 1.35920055e-4, 1.36371634e-4, 1.36941354e-4, 1.37497873e-4, 1.38329979e-4,
     1.38981090e-4, 1.39719676e-4, 1.40596483e-4, 1.41573836e-4, 1.42701064e-4, 1.43912407e-4, 1.45127755e-4, 1.46710702e-4, 1.48201619e-4, 1.49963009e-4,
     1.51809861e-4, 1.53750193e-4, 1.55815317e-4, 1.57693897e-4, 1.59629003e-4, 1.61541153e-4, 1.63306339e-4, 1.64888939e-4, 1.66286077e-4, 1.67668695e-4,
     1.68815611e-4, 1.69629768e-4, 1.70307707e-4, 1.70592642e-4, 1.70837390e-4, 1.70905017e-4, 1.70730284e-4, 1.70560321e-4, 1.70279811e-4, 1.69980969e-4,
     1.69683568e-4, 1.69203059e-4, 1.68858534e-4, 1.68509619e-4, 1.68194840e-4, 1.67681333e-4, 1.67199028e-4, 1.66717819e-4, 1.66199767e-4, 1.65735840e-4,
     1.65420369e-4, 1.65032314e-4, 1.64890865e-4, 1.64715724e-4, 1.64497541e-4, 1.64412240e-4, 1.64324793e-4, 1.64276994e-4, 1.64155537e-4, 1.64020542e-4,
     1.64016963e-4, 1.63898890e-4, 1.64032362e-4, 1.64045267e-4, 1.64195414e-4, 1.64285742e-4, 1.64460407e-4, 1.64661763e-4, 1.64738587e-4, 1.64862909e-4,
     1.65076816e-4, 1.65024997e-4, 1.65162453e-4, 1.65237474e-4, 1.65562552e-4, 1.65709225e-4, 1.66142295e-4, 1.66413982e-4, 1.66803643e-4, 1.67161297e-4,
     1.67479188e-4, 1.67667097e-4, 1.67864791e-4, 1.68139958e-4, 1.68233347e-4, 1.68368232e-4, 1.68734109e-4, 1.68895921e-4, 1.69306212e-4, 1.69651966e-4,
     1.69946857e-4, 1.70444809e-4, 1.70732732e-4, 1.71135157e-4, 1.71231516e-4, 1.71550211e-4, 1.71696417e-4, 1.71827084e-4, 1.72142950e-4, 1.72525391e-4,
     1.72856514e-4, 1.73390715e-4, 1.73767822e-4, 1.74328441e-4, 1.74893554e-4, 1.75395641e-4, 1.75742115e-4, 1.76164298e-4, 1.76419331e-4, 1.76746627e-4,
     1.76913681e-4, 1.77372254e-4, 1.77897899e-4, 1.78453513e-4, 1.79169646e-4, 1.79727818e-4, 1.80409802e-4, 1.81135436e-4, 1.81693575e-4, 1.82304987e-4,
     1.82840211e-4, 1.83218701e-4, 1.83686875e-4, 1.84158245e-4, 1.84720710e-4, 1.85261670e-4, 1.86044882e-4, 1.86910627e-4, 1.87744111e-4, 1.88640197e-4,
     1.89536957e-4, 1.90373887e-4, 1.91044376e-4, 1.91770554e-4, 1.92334227e-4, 1.93008156e-4, 1.93752580e-4, 1.94471581e-4, 1.95272205e-4, 1.96159946e-4,
     1.97179878e-4, 1.98147132e-4, 1.99205315e-4, 2.00512171e-4, 2.01401775e-4, 2.02350741e-4, 2.03121965e-4, 2.03880283e-4, 2.04553652e-4, 2.05224749e-4,
     2.05896678e-4, 2.06741041e-4, 2.07620395e-4, 2.08540576e-4, 2.09373829e-4, 2.10385794e-4, 2.11266605e-4, 2.12109107e-4, 2.12682109e-4, 2.13305338e-4,
     2.13902214e-4, 2.14484164e-4, 2.14843762e-4, 2.15242449e-4, 2.15718844e-4, 2.16421684e-4, 2.17195290e-4, 2.18005590e-4, 2.18962077e-4, 2.19991471e-4,
     2.20919919e-4, 2.21546974e-4, 2.22053928e-4, 2.22555080e-4, 2.23237798e-4, 2.23532485e-4, 2.23996613e-4, 2.24501430e-4, 2.25173147e-4, 2.25737767e-4,
     2.26423767e-4, 2.27365037e-4, 2.28449699e-4, 2.29400621e-4, 2.30377333e-4, 2.31057918e-4, 2.31964152e-4, 2.32623742e-4, 2.33166196e-4, 2.33650080e-4,
     2.34105936e-4, 2.34878659e-4, 2.35394209e-4, 2.36099367e-4, 2.37123530e-4, 2.38223666e-4, 2.39309613e-4, 2.40405595e-4, 2.41495657e-4, 2.42458496e-4,
     2.43313474e-4, 2.44175726e-4, 2.44734401e-4, 2.45486851e-4, 2.45993980e-4, 2.46800743e-4, 2.47463201e-4, 2.48445219e-4, 2.49488279e-4, 2.50569021e-4,
     2.51747840e-4, 2.52951109e-4, 2.54188859e-4, 2.55386833e-4, 2.56298369e-4, 2.57479006e-4, 2.58213101e-4, 2.59065147e-4, 2.60018887e-4, 2.61076885e-4,
     2.62283407e-4, 2.63904910e-4, 2.65792030e-4, 2.67956880e-4, 2.70494493e-4, 2.73225853e-4, 2.76170072e-4, 2.79055057e-4, 2.81984548e-4, 2.88500954e-4,
     2.89109910e-4, 2.93129400e-4, 2.92536512e-4, 2.92536512e-4]  # [uJ cnt-1] 10 sensitivities per line, 1024 total

DARK_REF =\
     [337.70483000000000, 338.16013791719934, 338.61548740418232, 339.07087845402685, 339.52631105981055, 339.98178521461114, 340.43730091150644,       340.89285814357419, 341.3484569038921, 341.80409718553784, 342.25977898158919, 342.71550228512388, 343.17126708921978, 343.62707338695441, 344.08292117140553, 344.53881043565104, 344.99474117276856, 345.45071337583585, 345.90672703793064, 346.36278215213059, 346.81887871151361, 347.27501670915728, 347.73119613813941, 348.1874169915377, 348.64367926242988, 349.09998294389374, 349.556328029007, 350.01271451084739, 350.46914238249252, 350.92561163702027, 351.38212226750841, 351.83867426703461, 352.29526762867653, 352.75190234551195, 353.20857841061871, 353.66529581707442, 354.122054557957, 354.57885462634391, 355.035696015313, 355.49257871794208, 355.94950272730881, 356.406468036491, 356.86347463856623, 357.32052252661248, 357.77761169370723, 358.23474213292837, 358.69191383735358, 359.14912680006063, 359.60638101412718, 360.06367647263107, 360.52101316865003, 360.97839109526166, 361.43581024554385, 361.89327061257421, 362.35077218943064, 362.80831496919069, 363.26589894493213, 363.72352410973286, 364.18119045667038, 364.63889797882263, 365.09664666926722, 365.55443652108193, 366.01226752734448, 366.47013968113254, 366.92805297552405, 367.38600740359658, 367.84400295842789, 368.30203963309566, 368.76011742067777, 369.21823631425184, 369.67639630689564, 370.1345973916869, 370.59283956170333, 371.05112281002272, 371.50944712972284, 371.96781251388126, 372.42621895557591, 372.88466644788434, 373.34315498388452, 373.80168455665387, 374.2602551592704, 374.71886678481172, 375.17751942635567, 375.63621307697986, 376.09494772976205, 376.55372337778, 377.01254001411138, 377.47139763183407, 377.93029622402577, 378.38923578376404, 378.84821630412677, 379.30723777819173, 379.76630019903661, 380.22540355973905, 380.68454785337696, 381.14373307302782, 381.60295921176964, 382.06222626268004, 382.52153421883673, 382.9808830733175, 383.4402728192, 383.89970344956208, 384.35917495748134, 384.81868733603568, 385.2782405783027, 385.73783467736013, 386.19746962628591, 386.65714541815743, 387.11686204605274, 387.57661950304936, 388.03641778222516, 388.49625687665792, 388.95613677942521, 389.41605748360485, 389.87601898227456, 390.33602126851207, 390.79606433539516, 391.25614817600149, 391.71627278340884, 392.176438150695, 392.63664427093761, 393.09689113721447, 393.55717874260324, 394.01750708018176, 394.47787614302763, 394.9382859242188, 395.39873641683278, 395.85922761394738, 396.3197595086404, 396.7803320939895, 397.24094536307246, 397.70159930896693, 398.16229392475077, 398.62302920350163, 399.08380513829724, 399.54462172221548, 400.00547894833386, 400.46637680973032, 400.92731529948242, 401.38829441066804, 401.84931413636485, 402.31037446965053, 402.77147540360289, 403.23261693129962, 403.69379904581859, 404.15502174023737, 404.61628500763373, 405.0775888410854, 405.53893323367032, 406.00031817846588, 406.46174366855, 406.92320969700046, 407.38471625689488, 407.84626334131104, 408.30785094332674, 408.76947905601963, 409.2311476724675, 409.69285678574812, 410.1546063889391, 410.61639647511822, 411.07822703736321, 411.54009806875189, 412.00200956236188, 412.46396151127107, 412.925953908557, 413.38798674729759, 413.85006002057037, 414.31217372145335, 414.77432784302397, 415.23652237836018, 415.69875732053964, 416.16103266263997, 416.62334839773911, 417.08570451891478, 417.54810101924454, 418.01053789180628, 418.47301512967766, 418.93553272593641, 419.39809067366025, 419.86068896592707, 420.32332759581442, 420.78600655640008, 421.24872584076189, 421.71148544197746, 422.17428535312456, 422.63712556728103, 423.10000607752437, 423.56292687693252, 424.02588795858316, 424.488889315554, 424.95193094092281, 425.41501282776733, 425.87813496916522, 426.34129735819425, 426.80449998793227, 427.26774285145689, 427.73102594184581, 428.19434925217689, 428.65771277552773, 429.12111650497621, 429.5845604336, 430.0480445544768, 430.51156886068441, 430.97513334530049, 431.4387380014029, 431.90238282206917, 432.36606780037721, 432.82979292940468, 433.29355820222935, 433.75736361192895, 434.22120915158121, 434.68509481426383, 435.14902059305462, 435.61298648103121, 436.07699247127152, 436.5410385568531, 437.00512473085365, 437.46925098635108, 437.93341731642306, 438.3976237141473, 438.86187017260164, 439.32615668486363, 439.79048324401106, 440.2548498431218, 440.71925647527343, 441.18370313354376, 441.64818981101047, 442.11271650075145, 442.57728319584419, 443.04188988936664, 443.50653657439642, 443.9712232440113, 444.43594989128906, 444.9007165093073, 445.36552309114387, 445.83036962987649, 446.29525611858287, 446.76018255034074, 447.22514891822789, 447.69015521532197, 448.15520143470076, 448.6202875694421, 449.08541361262354, 449.55057955732292, 450.01578539661796, 450.48103112358638, 450.9463167313059, 451.41164221285425, 451.87700756130931, 452.34241276974859, 452.80785783125, 453.27334273889124, 453.73886748574995, 454.20443206490393, 454.67003646943095, 455.13568069240864, 455.60136472691482, 456.06708856602734, 456.53285220282368, 456.99865563038173, 457.46449884177918, 457.93038183009384, 458.39630458840338, 458.86226710978548, 459.328269387318, 459.79431141407849, 460.26039318314497, 460.726514687595, 461.19267592050625, 461.65887687495655, 462.12511754402362, 462.59139792078525, 463.057717998319, 463.52407776970279, 463.9904772280143, 464.45691636633126, 464.92339517773138, 465.38991365529245, 465.85647179209212, 466.32306958120824, 466.78970701571848, 467.25638408870049, 467.72310079323211, 468.18985712239106, 468.65665306925507, 469.12348862690192, 469.59036378840932, 470.05727854685495, 470.52423289531663, 470.991226826872, 471.45826033459883, 471.92533341157485, 472.39244605087782, 472.85959824558552, 473.3267899887756, 473.79402127352591, 474.261292092914, 474.72860244001771, 475.19595230791487, 475.663341689683, 476.1307705784, 
     476.59823896714357, 477.06574684899141, 477.53329421702131, 478.00088106431093, 478.46850738393817, 478.93617316898053, 479.40387841251595, 479.87162310762204, 480.33940724737653, 480.80723082485724, 481.2750938331418, 481.74299626530808, 482.2109381144337, 482.67891937359644, 483.146940035874, 483.61500009434434, 484.08309954208482, 484.55123837217332, 485.01941657768771, 485.48763415170561, 485.95589108730474, 486.42418737756293, 486.89252301555786, 487.36089799436724, 487.82931230706873, 488.2977659467403, 488.76625890645943, 489.23479117930407, 489.70336275835177, 490.17197363668038, 490.6406238073676, 491.10931326349123, 491.57804199812892, 492.04681000435841, 492.51561727525751, 492.98446380390385, 493.4533495833752, 493.92227460674928, 494.39123886710394, 494.86024235751677, 495.32928507106561, 495.79836700082819, 496.26748813988212, 496.73664848130528, 497.2058480181754, 497.67508674357009, 498.14436465056713, 498.61368173224434, 499.08303798167935, 499.55243339195, 500.02186795613392, 500.491341667309, 500.96085451855276, 501.43040650294313, 501.89999761355773, 502.36962784347423, 502.83929718577053, 503.30900563352435, 503.77875317981329, 504.2485398177152, 504.71836554030779, 505.18823034066878, 505.65813421187596, 506.128077147007, 506.59805913913959, 507.06808018135155, 507.53814026672057, 508.00823938832445, 508.47837753924085, 508.94855471254766, 509.41877090132238, 509.88902609864283, 510.35932029758686, 510.82965349123208, 511.30002567265626, 511.77043683493713, 512.24088697115246, 512.71137607437993, 513.1819041376973, 513.65247115418242, 514.12307711691278, 514.59372201896633, 515.06440585342079, 515.53512861335378, 516.005890291843, 516.47669088196631, 516.9475303768013, 517.41840876942592, 517.88932605291791, 518.36028222035475, 518.83127726481439, 519.30231117937456, 519.77338395711286, 520.244495591107, 520.71564607443486, 521.18683540017412, 521.65806356140251, 522.12933055119777, 522.60063636263783, 523.0719809888, 523.54336442276235, 524.01478665760249, 524.4862476863982, 524.95774750222722, 525.42928609816715, 525.90086346729584, 526.3724796026911, 526.84413449743056, 527.31582814459193, 527.78756053725328, 528.25933166849177, 528.73114153138545, 529.20299011901216, 529.67487742444939, 530.1468034407751, 530.61876816106678, 531.09077157840238, 531.56281368585962, 532.03489447651611, 532.50701394344969, 532.979172079738, 533.45136887845877, 533.92360433268982, 534.395878435509, 534.86819117999369, 535.34054255922206, 535.81293256627146, 536.28536119421983, 536.757828436145, 537.2303342851244, 537.702878734236, 538.17546177655754, 538.64808340516652, 539.12074361314092, 539.59344239355835, 540.06617973949687, 540.53895564403365, 541.01177010024685, 541.484623101214, 541.95751464001285, 542.4304447097212, 542.90341330341687, 543.37642041417735, 543.84946603508058, 544.32255015920441, 544.7956727796261, 545.268833889424, 545.74203348167543, 546.21527154945818, 546.68854808585, 547.16186308392867, 547.635216536772, 548.10860843745752, 548.58203877906317, 549.05550755466675, 549.52901475734564, 550.00256038017778, 550.47614441624091, 550.94976685861286, 551.42342770037124, 551.89712693459376, 552.37086455435815, 552.84464055274236, 553.31845492282389, 553.79230765768057, 554.26619875039, 554.74012819403026, 555.21409598167872, 555.68810210641323, 556.1621465613116, 556.63622933945146, 557.11035043391064, 557.58450983776686, 558.05870754409784, 558.53294354598131, 559.007217836495, 559.48153040871648, 559.95588125572374, 560.4302703705946, 560.90469774640644, 561.3791633762371, 561.85366725316464, 562.32820937026634, 562.80278972062013, 563.277408297304, 563.75206509339523, 564.22676010197188, 564.70149331611151, 565.17626472889185, 565.65107433339085, 566.125922122686, 566.600808089855, 567.075732227976, 567.55069453012641, 568.025694989384, 568.50073359882629, 568.97581035153144, 569.45092524057691, 569.92607825904042, 570.40126939999993, 570.876498656533, 571.35176602171748, 571.827071488631, 572.30241505035133, 572.77779669995618, 573.25321643052337, 573.72867423513037, 574.20417010685526, 574.67970403877564, 575.15527602396924, 575.63088605551377, 576.10653412648708, 576.58222022996665, 577.05794435903033, 577.53370650675606, 578.00950666622134, 578.485344830504, 578.96122099268177, 579.43713514583237, 579.91308728303363, 580.389077397363, 580.86510548189858, 581.34117152971794, 581.81727553389874, 582.29341748751881, 582.76959738365576, 583.24581521538744, 583.72207097579167, 584.19836465794606, 584.67469625492845, 585.15106575981645, 585.62747316568777, 586.10391846562015, 586.58040165269153, 587.05692271997953, 587.53348166056162, 588.010078467516, 588.48671313392015, 588.9633856528518, 589.44009601738867, 589.91684422060871, 590.39363025558953, 590.87045411540873, 591.347315793144, 591.82421528187342, 592.30115257467435, 592.77812766462478, 593.25514054480232, 593.732191208285, 594.20927964815007, 594.68640585747551, 595.16356982933917, 595.64077155681855, 596.11801103299138, 596.5952882509356, 597.07260320372893, 597.549955884449, 598.0273462861735, 598.5047744019804, 598.98224022494708, 599.45974374815182, 599.93728496467168, 600.41486386758481, 600.89248044996884, 601.3701347049016, 601.84782662546058, 602.32555620472385, 602.803323435769, 603.28112831167368, 603.75897082551569, 604.23685097037264, 604.71476873932249, 605.192724125443, 605.67071712181155, 606.1487477215062, 606.62681591760463, 607.10492170318446, 607.58306507132352, 608.06124601509964, 608.53946452759033, 609.01772060187352, 609.49601423102683, 609.974345408128, 610.4527141262547, 610.931120378485, 611.40956415789628, 611.88804545756636, 612.366564270573, 612.84512058999394, 613.32371440890688, 613.80234572038955, 614.28101451751979, 614.75972079337521, 615.23846454103375, 615.7172457535728, 616.19606442407041, 616.6749205456041, 617.15381411125179, 617.63274511409134, 618.1117135472, 618.59071940365584, 619.06976267653647, 619.54884335891984, 620.02796144388356, 620.50711692450523, 620.98630979386269, 621.46554004503366, 621.94480767109587, 622.42411266512715, 622.90345502020512, 623.3828347294077, 623.86225178581242, 624.341706182497, 624.82119791253922, 625.300726969017, 625.78029334500786, 626.2598970335896, 626.73953802784, 627.21921632083684, 627.69893190565756, 628.17868477538025, 628.65847492308239, 629.13830234184206, 629.61816702473652, 630.09806896484383, 630.5780081552416, 631.05798458900756, 631.53799825921953, 632.01804915895536, 632.49813728129243, 632.97826261930868, 633.458425166082, 633.93862491468985, 634.41886185821, 634.89913598972043, 635.37944730229867, 635.85979578902254, 636.34018144296965, 636.82060425721784, 637.30106422484482, 637.78156133892833, 638.26209559254607, 638.7426669787759, 639.22327549069541, 639.70392112138245, 640.1846038639145, 640.66532371136964, 641.14608065682546, 641.62687469335958, 642.10770581405, 642.58857401197417, 643.06947928021009, 643.55042161183519, 644.03140099992754, 644.51241743756452, 644.99347091782431, 645.47456143378429, 645.95568897852218, 646.43685354511592, 646.91805512664325, 647.39929371618177, 647.88056930680921, 648.36188189160328, 648.84323146364181, 649.32461801600255, 649.80604154176319, 650.28750203400148, 650.76899948579512, 651.250533890222, 651.73210524035949, 652.21371352928577, 652.6953587500783, 653.17704089581491, 653.65875995957322, 654.14051593443128, 654.62230881346647, 655.10413858975664, 655.58600525637939, 656.0679088064129, 656.54984923293443, 657.03182652902194, 657.51384068775315, 657.99589170220565, 658.47797956545742, 658.96010427058593, 659.44226581066914, 659.92446417878477, 660.40669936801032, 660.88897137142374, 661.37128018210274, 661.853625793125, 662.33600819756839, 662.81842738851049, 663.30088335902906, 663.78337610220183, 664.26590561110652, 664.74847187882108, 665.231074898423, 665.71371466299013, 666.19639116560006, 666.67910439933064, 667.1618543572597, 667.64464103246473, 668.12746441802358, 668.61032450701418, 669.093221292514, 669.57615476760088, 670.05912492535253, 670.54213175884661, 671.02517526116117, 671.50825542537359, 671.99137224456183, 672.47452571180349, 672.9577158201763, 673.440942562758, 673.92420593262648, 674.4075059228594, 674.89084252653436, 675.37421573672918, 675.8576255465216, 676.34107194898934, 676.82455493721022, 677.308074504262, 677.79163064322222, 678.27522334716878, 678.75885260917926, 679.24251842233161, 679.72622077970334, 680.20995967437239, 680.69373509941636, 681.17754704791309, 681.6613955129402, 682.14528048757541, 682.62920196489665, 683.11315993798144, 683.59715439990771, 684.081185343753, 684.56525276259515, 685.04935664951176, 685.53349699758087, 686.01767379988, 686.50188704948675, 686.98613673947909, 687.47042286293481, 687.95474541293129, 688.4391043825467, 688.92349976485843, 689.40793155294443, 689.89239973988231, 690.37690431875, 690.861445282625, 691.34602262458509, 691.83063633770814, 692.3152864150718, 692.79997284975366, 693.28469563483168, 693.76945476338358, 694.25425022848685, 694.73908202321957, 695.22395014065933, 695.70885457388363, 696.19379531597053, 696.67877235999765, 697.16378569904271, 697.64883532618353, 698.13392123449773, 698.61904341706315, 699.1042018669574, 699.5893965772583, 700.07462754104358, 700.559894751391, 701.04519820137818, 701.53053788408306, 702.01591379258321, 702.50132591995634, 702.9867742592802, 703.4722588036326, 703.95777954609127, 704.44333647973406, 704.92892959763844, 705.41455889288227, 705.90022435854326, 706.38592598769924, 706.87166377342794, 707.35743770880686, 707.843247786914, 708.32909400082713, 708.81497634362381, 709.30089480838171, 709.78684938817878, 710.27284007609262, 710.75886686520118, 711.24492974858185, 711.73102871931246, 712.21716377047085, 712.70333489513484, 713.189542086382, 713.67578533729, 714.16206464093671, 714.6483799904, 715.13473137875735, 715.62111879908662, 716.10754224446544, 716.59400170797176, 717.08049718268308, 717.56702866167734, 718.053596138032, 718.54019960482515, 719.02683905513436, 719.51351448203718, 720.00022587861167, 720.48697323793533, 720.973756553086, 721.46057581714138, 721.94743102317909, 722.434322164277, 722.921249233513, 723.40821222396448, 723.89521112870943, 724.38224594082556, 724.86931665339046, 725.35642325948209, 725.84356575217794, 726.330744124556, 726.81795836969377, 727.30520848066908, 727.79249445055962, 728.27981627244321, 728.76717393939759, 729.25456744450048, 729.74199678082948, 730.22946194146243, 730.71696291947717, 731.20449970795119, 731.69207229996255, 732.17968068858863, 732.66732486690739, 733.15500482799655, 733.64272056493371, 734.13047207079671, 734.61825933866339, 735.10608236161136, 735.59394113271821, 736.08183564506214, 736.56976589172041, 737.05773186577085, 737.54573356029141, 738.03377096835959, 738.52184408305334, 739.00995289745, 739.49809740462786, 739.98627759766418, 740.474493469637, 740.96274501362382, 741.45103222270257, 741.939355089951, 742.42771360844677, 742.91610777126743, 743.404537571491, 743.89300300219509, 744.38150405645752, 744.870040727356, 745.35861300796807, 745.84722089137176, 746.33586437064457, 746.82454343886434, 747.3132580891089, 747.80200831445575, 748.29079410798272, 748.77961546276765, 749.26847237188815, 749.757364828422, 750.246292825447, 750.73525635604085, 751.22425541328118, 751.71328999024593, 752.20236008001268, 752.69146567565906, 753.18060677026313, 753.66978335690237, 754.15899542865463, 754.64824297859752, 755.13752599980887, 755.62684448536641, 756.11619842834784, 756.60558782183114, 757.09501265889367, 757.58447293261327, 758.07396863606766, 758.5634997623348, 759.05306630449218, 759.54266825561774, 760.032305608789, 760.52197835708375, 761.01168649357976, 761.501430011355, 761.99120890348672, 762.481023163053, 762.97087278313143, 763.4607577568, 763.95067807713622, 764.44063373721769, 
     764.9306247301223, 765.42065104892788, 765.91071268671226, 766.40080963655271, 766.8909418915274, 767.38110944471384, 767.87131228919, 768.36155041803318, 768.85182382432163, 769.34213250113271, 769.83247644154437, 770.32285563863411, 770.81327008548, 771.30371977515961, 771.79420470075058, 772.28472485533064, 772.77528023197783, 773.26587082376966, 773.75649662378373, 774.247157625098, 774.73785382079006, 775.22858520393788, 775.71935176761883, 776.21015350491086, 776.7009904088917, 777.19186247263917, 777.68276968923078, 778.17371205174436, 778.66468955325786, 779.15570218684854, 779.64674994559471, 780.13783282257373, 780.62895081086344, 781.12010390354146, 781.61129209368573, 782.102515374374, 782.59377373868369, 783.08506717969283, 783.576395690479, 784.06775926412013, 784.55915789369362, 785.05059157227754, 785.54206029294937, 786.03356404878707, 786.52510283286813, 787.01667663827061, 787.508285458072, 787.99992928534994, 788.49160811318245, 788.98332193464717, 789.47507074282169, 789.966854530784, 790.4586732916116, 790.95052701838245, 791.442415704174, 791.93433934206416, 792.42629792513071, 792.91829144645112, 793.41031989910368, 793.90238327616555, 794.39448157071456, 794.88661477582866, 795.37878288458558, 795.87098589006291, 796.3632237853385, 796.85549656349, 797.34780421759513, 797.8401467407316, 798.33252412597733, 798.82493636640982, 799.317383455107, 799.80986538514651, 800.30238214960627, 800.79493374156368, 801.28752015409668, 801.780141380283, 802.27279741320035, 802.76548824592646, 803.258213871539, 803.75097428311585, 804.24376947373457, 804.736599436473, 805.22946416440891, 805.72236365062008, 806.215297888184, 806.70826687017859, 807.20127058968171, 807.6943090397707, 808.18738221352373, 808.6804901040183, 809.17363270433214, 809.66681000754306, 810.16002200672892, 810.6532686949671, 811.14655006533565, 811.63986611091207, 812.13321682477442, 812.62660220000009, 813.12002222966692, 813.61347690685272, 814.10696622463524, 814.60049017609208, 815.09404875430118, 815.58764195234, 816.08126976328651, 816.57493218021841, 817.06862919621335, 817.562360804349, 818.05612699770336, 818.5499277693541, 819.04376311237877, 819.53763301985521, 820.031537484861, 820.52547650047416, 821.01945005977234, 821.51345815583306, 822.00750078173428, 822.50157793055359, 822.995689595369, 823.48983576925787]

def calculateDownwellingSpectralFlux(wvl_lgr, spectrum):
    '''
    This function will calculate the downwelling spectral flux.
    A desired type for wvl_lgr would be a single 1D list, and spectrum
    should be a nested 2D list. The area for spectrometer and integration
    time are default.

    This function is based on the following algorithm, provided by Solmaz in 
    https://github.com/terraref/reference-data/issues/30#issuecomment-253000597

    Ip = (Sp - Dp) * Cp / (T * A * dLp) 
    dL = [L(p + 1) - L(p - 1)] / 2

    Here:
    **Denominator**
    AREA                          -> the area of the sensor (A above)
    Spectrometer_Integration_Time -> integartion time (5000us, T above)
    delta                         -> The wavelength spread (dL above)

    **Numerator**
    spectrum                      -> the spectrum, a 2D array(Sp above)
    DARK_REF                      -> the dark reference (Dp above)
    FLX_SNS                       -> the calibration (Cp above)  
    '''

    Spectrometer_Integration_Time_In_Microseconds = 5000.0 # [us]
    Spectrometer_Integration_Time                 = Spectrometer_Integration_Time_In_Microseconds * 1.0e-6 # [s]

    wvl_ntf  = [np.average([wvl_lgr[i], wvl_lgr[i+1]]) for i in range(len(wvl_lgr)-1)]
    delta    = [wvl_ntf[i+1] - wvl_ntf[i] for i in range(len(wvl_ntf) - 1)]
    delta.insert(0,  2*(wvl_ntf[0]  - wvl_lgr[0]))
    delta.insert(-1, 2*(wvl_lgr[-1] - wvl_ntf[-1]))

    # Using dark reference to calibrate the original sperctrum value
    for i in range(len(spectrum)):
        for j in range(len(spectrum[i])):
            if j < len(DARK_REF): spectrum[i][j] -= DARK_REF[i]

    # General formula used in calculating downwelling spectral flux:
    # Downwelling Spectral Flux = (spectrum [cnt] - dark [cnt]) * flx_sns [J cnt-1]  / bandwidth [m] / area [m2] / time [s]
    downwellingSpectralFlux = np.array(FLX_SNS) * 1.0e-6 * np.array(spectrum) / np.array(delta) / AREA / Spectrometer_Integration_Time # [J m-2 m-1 s-1] = [W m-2 m-1]

    # downwellingFlux is the summation (integration) of downwelling flux
    downwellingFlux = np.sum(downwellingSpectralFlux)

    return downwellingSpectralFlux, downwellingFlux  